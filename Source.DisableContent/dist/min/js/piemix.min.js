!function(){"use strict";function e(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"_"+e()}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.replaceAll=function(e,t){var n=new RegExp(e,"g");return this.replace(n,t)},angular.module("piemix.modules",["ngSanitize","ui.bootstrap"]).directive("pieMix",function(){return{restrict:"AEC",scope:{slices:"="},templateUrl:"resource/piemix.html",controller:["$scope","$timeout",function(t,n){var r=this;this.baseRadius=100,this.radiusIncrementFactor=.66,r.coordinates={},r._generateCoordinates=function(e,t,n){var a=e+"deg_"+t+"_rad"+n.toString();if("undefined"!=typeof r.coordinates[a]&&null!=r.coordinates[a])return r.coordinates[a];var i=0,o=0,c=Math.abs(t*Math.sin(.0174533*e)),d=Math.abs(t*Math.cos(.0174533*e));return e>=0&&90>=e?(i=n.x+c,o=n.y-d):e>=90&&180>=e?(i=n.x+c,o=n.y+d):e>=180&&270>=e?(i=n.x-c,o=n.y+d):(i=n.x-c,o=n.y-d),r.coordinates[a]={x:Math.ceil(i),y:Math.ceil(o)},r.coordinates[a]},r.generatedPies=[],r._generatePies=function(t,n,a){var i=_.reduce(t,function(e,t){return e+t.value},0),o=0;_.each(t,function(t,c){for(var d=0,s=r.baseRadius,l=r.baseRadius;n-1>d;)l*=r.radiusIncrementFactor,s+=l,d+=1;var u=360;"undefined"!=typeof a&&null!=a&&"undefined"!=typeof a.deg&&null!=a.deg&&(u=a.deg);var g=Math.ceil(t.value/i*u),f=o+g,h=o+g+("undefined"!=typeof t.degStart&&null!=t.degStart&&t.degStart!={}?t.degStart:0),p=r._generateCoordinates(o,s,r.centerXY),x=r._generateCoordinates(h,s,r.centerXY),v=0;g>180&&(v=1),t._uid=e(),t.rad=s,t.deg=g,t.degStart=f-g,t.degEnd=f,t.startXY=p,t.endXY=x,t.pathCoeff=v,t.activecolor=t.color,t.priority=n;var y="M"+t.startXY.x+" "+t.startXY.y+" A "+t.rad+" "+t.rad+", 0, "+t.pathCoeff+", 1, "+t.endXY.x+" "+t.endXY.y+" L "+r.centerXY.x+" "+r.centerXY.y+" Z";t.d=y;var m=_.clone(t);delete m.child,r.generatedPies.push(m),"undefined"!=typeof t.child&&t.child!={}&&t.child.length>0&&r._generatePies(t.child,n+1,t),o=f})},r._calDeepLength=function(e){var t=0;return e.length>0&&(t+=1),_.each(e,function(e){"undefined"!=typeof e.child&&e.child!={}&&e.child.length>0&&(t+=r._calDeepLength(e.child))}),t},r._calMaxRadius=function(e){for(var t=r._calDeepLength(e),n=r.baseRadius,a=0;t-1>a;)n+=r.baseRadius*r.radiusIncrementFactor,a+=1;return n},r._getCenterXY=function(e,t){return r._maxRad=r._calMaxRadius(e),t="undefined"!==t&&t!={}&&null!=t?t:0,{x:r._maxRad+2*t,y:r._maxRad+2*t}},r._startGenerating=function(e){r.generatedPies=[],r.centerXY=r._getCenterXY(e,5),r._generatePies(e,1,null),r.svgHeight=r.svgWidth=2*r._maxRad,console.log(r.generatedPies)},r.click=function(e){console.log(e)}}],controllerAs:"piemixctrl",bindToController:!0,replace:!0,link:function(e,t,n,r){e.$watch(function(e){return e.slices},function(e){console.log(r),r._startGenerating(r.slices)})}}})}();
!function(){"use strict";var t={pieMixMasterTmpl:'        <div class="pie-mix-holder">            <svg height="{{piemixctrl.svgHeight}}" width="{{piemixctrl.svgWidth}}" version="1.1" xmlns="http://www.w3.org/2000/svg">                <path tabindex="0" ng-attr-fill="{{path.activecolor}}" ng-attr-d="{{path.d}}" ng-attr-priority="{{path.priority}}" style="fill: {{path.activecolor}}" ng-repeat="path in piemixctrl.generatedPies  | orderBy:\'priority\':\'false\'" ng-click="sample.click(path.id)" ng-mouseenter="path.activecolor = \'#000\'" ng-mouseleave="path.activecolor = path.color"/>            </svg>        </div>    '};angular.module("piemix.modules").run(["$templateCache",function(e){e.put("template/piemix/template.html",t.pieMixMasterTmpl)}])}();